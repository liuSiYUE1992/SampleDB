# SampleDB

## 数据结构的选择
- B+ 树
    B+ 树是由二分查找树演化而来，通过增加每层中节点来减少层级，降低树的高度，适配磁盘的页，尽量减少磁盘IO操作<br/>
    B+ 树查询性能比较稳定，在写入或者更新时，会查找并定位到磁盘的未知并进行原地操作，B+树适合读多写少的场景
- LSM 树
    日志结构合并树，其实并不是一种具体树类型的数据结构，而是数据存储的模型，核心的思想基于一个事实，顺序IO远快于随机IO<br/>
    和B+树不同的是，在LSM 中，数据的哈如、更新、删除都会被记录成一条日志，随后追加写入磁盘文件中，这样所有的操作都是顺序IO,LSM 使用与写多读少的场景

## 数据封装并存入磁盘
为了防止数据丢失，每个存入的数据封装成entry ，主驾到磁盘文件中。Entry 中的类容大致是 key value  写入时间，<br/>
所以磁盘文件的结构非常简单，就是多个Entry的集合

## 磁盘更新后如何保存到内存
内存中可以选择一个简单的数据结构，比如哈希表，hash 表中的可以对应Entry在磁盘中的未知，便于查找时进行获取<br/>

## PUT
1. 磁盘记录的追加
2. 内存中追加一条索引


## GET
1. 内存中在哈希表总找到key 对应的索引信息
2. 根据索引信息到磁盘当中去取出 value 

## DEL
然后是删除操作，这里并不会定位到原记录进行删除，而还是将删除的操作封装成 Entry，追加到磁盘文件当中，只是这里需要标识一下 Entry 的类型是删除

## merge
清除无效文件
1. 创建临时文件，复制数据文件中的有效数据
2. 删除数据文件，临时文件变为数据文件